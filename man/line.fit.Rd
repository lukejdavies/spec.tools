\name{line.fit}
\alias{line.fit}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
Provides rough emission/absorption line fits using single gaussian profiles.
}
\description{
Function fits Gaussian profiles to line positions with based on a string name from load.lines() or a input wavelength. The user must supply a FWM value which defines the width of the fitting region. The function returns a data frame containing all of the best fit line parameters. The function also have the option of overplotting the line fits on the current plot.   
}
\usage{
line.fit(spec, linefit, z = NA, FWM = 65, plot = F, col='red')
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{spec}{
List with the same structure as that generated by get.spec.
}
  \item{linefit}{
Scalar or Vector containing lines to fit. Can be either string containing lines from load.lines() (i.e. c('OIIR','HA')) or line wavelengths. If set to 'all' the function will aim to fit all lines in load.lines()
}
  \item{z}{
Redshifts to estimate laod.lines() lines at. This is generally read from spec$z, but can be overridden here.
}
  \item{FWM}{
Range over which to fit each Gaussian.
}
  \item{plot}{
Should line fits be plotted? TRUE/FALSE
}
  \item{col}{
Colour to overplot fits.
}
}
\details{
%%  ~~ If necessary, more details than the description above ~~
}
\value{

\item{LINE_NAMES }{Line Name}
\item{LINE_WAVE }{Line wavelength}
\item{LINE_FLUX }{Measured flux in Gaussian fit}
\item{LINE_FLUX_ERR }{Error on measured flux in Gaussian fit}
\item{LINE_SN }{Line signal to noise}
\item{LINE_EW }{Line equivalent width}
\item{LINE_EW_ERR }{Error on line equivalent width}
\item{LINE_SIG }{Standard deviation of fitted Gaussian}
\item{CONT_FLUX }{Continuum flux at line position}

}
\references{
%% ~put references to the literature/web site here ~
}
\author{
Luke Davies
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{
spec<-get.spec(paste(.libPaths(),'/fourXPS/data/ExampleSpec.fits',sep=''))
spec.plot(spec, main='Example Spectrum', col='navy', lwd=0.5)
line.fit(spec,'all', FWM=60, plot=T)

spec.plot(spec, main='Example Spectrum', xlim=c(8300,9000), col='navy', lwd=1)
line.fit(spec,c('HB','OIIIR'), FWM=65, plot=T, col='orange')

spec.plot(spec, main='Example Spectrum', xlim=c(6400,7100), col='navy', lwd=1)
line.fit(spec,c('OIIR','K', 'H'), FWM=49, plot=T, col='magenta')

}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{  }
\keyword{  }% __ONLY ONE__ keyword per line
